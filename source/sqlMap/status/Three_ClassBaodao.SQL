select * from(SELECT row_number() over(order by students.STUDENTNO)as row,RTRIM(students.STUDENTNO)as STUDENTNO,
students.NAME AS STUDENTNAME,
SEXCODE.NAME AS SEX,
 CONVERT(varchar(10),students.ENTERDATE,20) AS ENTERDATE,
students.YEARS AS YEARS,
students.CLASSNO AS CLASSNO,
students.WARN AS WARN,
RTRIM(personal.EXAMNO) AS EXAMNO,
personal.SCORE AS SCORE,
provincecode.NAME AS PROVINCE,
statusoptions.VALUE AS STATUS,
regdata.REGDATE AS REGDATE,
REGCODEOPTIONS.VALUE AS REGCODE,
'' AS STUDENTLINK,
'' AS PERSONALLINK
FROM STUDENTS JOIN PERSONAL ON STUDENTS.STUDENTNO=PERSONAL.STUDENTNO
LEFT OUTER JOIN PROVINCECODE ON PERSONAL.PROVINCE=PROVINCECODE.CODE
LEFT OUTER JOIN STATUSOPTIONS ON STUDENTS.STATUS=STATUSOPTIONS.NAME
LEFT OUTER JOIN REGDATA ON STUDENTS.STUDENTNO=REGDATA.STUDENTNO AND REGDATA.YEAR=:YEAR AND REGDATA.TERM=:TERM
LEFT OUTER JOIN REGCODEOPTIONS ON REGDATA.REGCODE=REGCODEOPTIONS.NAME
LEFT OUTER JOIN SEXCODE ON STUDENTS.SEX=SEXCODE.CODE
WHERE  (students.CLASSNO = :CLASSNO))as b where b.row between :start and :end

