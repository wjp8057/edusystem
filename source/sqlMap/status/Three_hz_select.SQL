select * from(SELECT row_number() over(order by SCHOOLS.SCHOOL)as row,SCHOOLS.SCHOOL,SCHOOLS.NAME,TOCOME.TOTAL,CAME.STOTAL,'' AS SCHOOLLINK
FROM SCHOOLS JOIN
(
  SELECT STUDENTS.SCHOOL,COUNT(STUDENTS.STUDENTNO) AS TOTAL
  FROM STUDENTS
  JOIN PERSONAL ON STUDENTS.STUDENTNO=PERSONAL.STUDENTNO
  WHERE ABS(MONTH(PERSONAL.DAYOFENROLL)-MONTH(GETDATE()))<=5
  AND YEAR(PERSONAL.DAYOFENROLL)=YEAR(GETDATE())
  GROUP BY STUDENTS.SCHOOL
) AS TOCOME ON SCHOOLS.SCHOOL=TOCOME.SCHOOL
LEFT OUTER JOIN
(
  SELECT STUDENTS.SCHOOL,COUNT(STUDENTS.STUDENTNO) AS STOTAL
  FROM STUDENTS JOIN PERSONAL ON STUDENTS.STUDENTNO=PERSONAL.STUDENTNO
  WHERE (STUDENTS.ENTERDATE IS NOT NULL)
  AND(ABS(MONTH(PERSONAL.DAYOFENROLL)-MONTH(GETDATE()))<=5)
  AND(YEAR(PERSONAL.DAYOFENROLL)=YEAR(GETDATE()))
  GROUP BY STUDENTS.SCHOOL
) AS CAME ON SCHOOLS.SCHOOL=CAME.SCHOOL)as b where b.row between :start and :end