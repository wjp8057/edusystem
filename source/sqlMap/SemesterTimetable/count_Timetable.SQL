SELECT COUNT(*) AS ROWS from(
    SELECT dbo.GETONE(RTRIM(COURSENOGROUP)) as kh,
    dbo.GETONE(RTRIM(COURSENAME)) as km,
    dbo.GETONE(CREDITS) AS xf,
    dbo.GETONE(WEEKHOURS) AS zxs,
    dbo.GETONE(WEEKEXPEHOURS) AS zsy,
    dbo.GETONE(RTRIM(COURSETYPE)) AS xk,
    dbo.GETONE(RTRIM(EXAMTYPE)) AS kh2,
    dbo.GETONE(RTRIM(SCHOOLNAME)) AS kkxy,
    dbo.GROUP_CONCAT_MERGE(RTRIM(CLASSNONAME),';') AS bj,
    dbo.GROUP_CONCAT_MERGE(RTRIM(TEACHERNONAME),';') AS js,
    dbo.GETONE(RTRIM(viewschedule.REM)) AS bz,
    dbo.GROUP_CONCAT_MERGE(RTRIM(DAYNTIME),';') AS kcap,
    dbo.GETONE(rtrim(ATTENDENTS)) AS xkrs,
    dbo.GETONE(rtrim(coursetypename)) AS kclx,
    dbo.GROUP_CONCAT_MERGE(RTRIM(VIEWSCHEDULE.TEACHERNO), '; ') AS jsh
FROM VIEWSCHEDULE,teachers
WHERE
   YEAR = :YEAR
   AND TERM = :TERM
   AND COURSENO LIKE :COURSENO
   AND COURSENAME LIKE :COURSENAME
   AND [GROUP] LIKE :GROUP
   AND VIEWSCHEDULE.SCHOOL LIKE :SCHOOL
   AND viewschedule.TYPE LIKE :COURSETYPE
   AND CLASSNO LIKE :CLASSNO
   AND CLASSNAME LIKE :CLASSNAME
   AND APPROACH LIKE :APPROACHES
   AND EXAM LIKE :EXAMTYPE
   AND ZC  LIKE :ZCSELECT
   AND (TEACHERNAME LIKE :TEACHERNAME  OR TEACHERNAME IS NULL)
   AND (VIEWSCHEDULE.TEACHERNO LIKE :TEACHERNO  OR VIEWSCHEDULE.TEACHERNO IS NULL)
   AND (DAY LIKE :DAY OR DAY IS NULL)
   AND (TIMEBITS & :TIME <>0  OR TIMEBITS IS NULL)
   and (teachers.SCHOOL LIKE :TEACHERSCHOOL) and VIEWSCHEDULE.teacherno=teachers.teacherno
   group by COURSENOGROUP
)as b

