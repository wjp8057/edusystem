select count(*) as ROWS from(SELECT row_number() over(order by COURSENOGROUP) as row,dbo.GETONE(RTRIM(COURSENOGROUP)) AS 课号,
    dbo.GETONE(RTRIM(COURSENAME)) AS 课名,
    dbo.GETONE(CREDITS) AS 学分,
    dbo.GETONE(WEEKHOURS) AS 周学时,
    dbo.GETONE(WEEKEXPEHOURS) AS 周实验,
    dbo.GETONE(RTRIM(COURSETYPE)) AS 修课,
    dbo.GETONE(RTRIM(EXAMTYPE)) AS 考核,
    dbo.GETONE(RTRIM(SCHOOLNAME)) AS 开课学院,
    dbo.GROUP_CONCAT_MERGE(RTRIM(CLASSNONAME),'; ') AS 班级,
    dbo.GROUP_CONCAT_MERGE(RTRIM(TEACHERNONAME),'; ') AS 教师,
    dbo.GETONE(RTRIM(REM)) AS 备注,
    dbo.GROUP_CONCAT_MERGE(RTRIM(DAYNTIME),';') AS 课程安排
FROM VIEWSCHEDULE
WHERE
   YEAR = :YEAR
   AND TERM = :TERM
   AND COURSENO LIKE :COURSENO
   AND COURSENAME LIKE :COURSENAME
   AND [GROUP] LIKE :GROUP
   AND SCHOOL LIKE :SCHOOL
   AND TYPE LIKE :COURSETYPE
   AND CLASSNO LIKE :CLASSNO
   AND CLASSNAME LIKE :CLASSNAME
   AND APPROACH LIKE :APPROACHES
   AND EXAM LIKE :EXAMTYPE
   AND (TEACHERNAME LIKE :TEACHERNAME OR TEACHERNAME IS NULL)
   AND (TEACHERNO LIKE :TEACHERNO OR TEACHERNO IS NULL)
   AND (DAY LIKE :DAY)
   AND (TIMEBITS & :TIME <>0)
group BY COURSENOGROUP)as b