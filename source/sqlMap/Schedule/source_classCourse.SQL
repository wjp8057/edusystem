SELECT row_number() over(order by SCHEDULE.COURSENO) as row,SCHEDULE.COURSENO+SCHEDULE.[GROUP] AS COURSE
,TIMESECTIONS.[VALUE] as jc,OEWOPTIONS.NAME as dsz,SCHEDULE.WEEKS,OEWOPTIONS.TIMEBIT&TIMESECTIONS.TIMEBITS2 AS TIMES,
SCHEDULE.DAY,SCHEDULE.TIME,SCHEDULE.OEW,SCHEDULE.WEEKS,COURSEPLAN.CLASSNO
FROM SCHEDULE JOIN COURSEPLAN
ON  SCHEDULE.YEAR=COURSEPLAN.YEAR
inner join TIMESECTIONS on TIMESECTIONS.NAME=SCHEDULE.TIME
inner join OEWOPTIONS on OEWOPTIONS.CODE=SCHEDULE.OEW
AND SCHEDULE.TERM=COURSEPLAN.TERM
AND SCHEDULE.[GROUP]=COURSEPLAN.[GROUP]
AND SCHEDULE.COURSENO=COURSEPLAN.COURSENO
WHERE  SCHEDULE.YEAR=:syear
AND SCHEDULE.TERM=:sterm
AND COURSEPLAN.CLASSNO in (SELECT DISTINCT(RTRIM(CLASSES.CLASSNO)) AS CLASSNO
FROM CLASSES JOIN COURSEPLAN ON CLASSES.CLASSNO=COURSEPLAN.CLASSNO
WHERE CLASSES.CLASSNO!= '000000' and  COURSEPLAN.YEAR=:tyear AND COURSEPLAN.TERM=:tterm)