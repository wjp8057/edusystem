select * from(select row_number() over(ORDER BY b.kh) as row,b.* from(SELECT DISTINCT SCHEDULE.YEAR xn, SCHEDULE.TERM xq,
SCHEDULE.COURSENO + SCHEDULE.[GROUP] kh,COURSES.COURSENAME km, SCHEDULE.ROOMNO jsh,CLASSROOMS.JSN jsm, CLASSROOMS.SEATS zws,
        SCHEDULEPLAN.ESTIMATE yjrs
FROM SCHEDULE INNER JOIN
      CLASSROOMS ON SCHEDULE.ROOMNO = CLASSROOMS.ROOMNO INNER JOIN
      COURSES ON SCHEDULE.COURSENO = COURSES.COURSENO INNER JOIN
      SCHEDULEPLAN ON SCHEDULE.YEAR = SCHEDULEPLAN.YEAR AND
      SCHEDULE.TERM = SCHEDULEPLAN.TERM AND
      SCHEDULE.COURSENO = SCHEDULEPLAN.COURSENO AND
      SCHEDULE.[GROUP] = SCHEDULEPLAN.[GROUP]
where SCHEDULE.year=:YEAR AND SCHEDULE.TERM=:TERM AND CLASSROOMS.SEATS-SCHEDULEPLAN.ESTIMATE>=:RS AND SCHEDULE.ROOMNO<>'000000000' AND SCHEDULE.ROOMNO<>'L00000006'
)as b) as c where c.row between :start and :end