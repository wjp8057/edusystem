SELECT count(*) as ROWS from (SELECT row_number() over(order by COURSENOGROUP)as row,dbo.GETONE(RTRIM(COURSENOGROUP)) AS kh,
    dbo.GETONE(RTRIM(COURSENAME)) AS km,
    dbo.GETONE(CREDITS) AS xf,
    dbo.GETONE(WEEKHOURS) AS zxs,
    dbo.GETONE(WEEKEXPEHOURS) AS zsy,
    dbo.GETONE(RTRIM(COURSETYPE)) AS xk,
    dbo.GETONE(RTRIM(EXAMTYPE)) AS kh2,
    dbo.GETONE(RTRIM(SCHOOLNAME)) AS kkxy,
    dbo.GROUP_CONCAT_MERGE(RTRIM(CLASSNONAME),'; ') AS class,
    dbo.GROUP_CONCAT_MERGE(RTRIM(TEACHERNONAME),'; ') AS js,
    dbo.GETONE(RTRIM(REM)) AS rem,
    dbo.GROUP_CONCAT_MERGE(RTRIM(DAYNTIME),'; ') AS kcap
FROM VIEWSCHEDULE
WHERE
   YEAR = :YEAR
   AND TERM = :TERM
   AND (TEACHERNO=:TEACHERNO)
   group by COURSENOGROUP
) as b