SELECT E.*,C.COURSENAME,T.NAME TEACHERNAME,T.SCHOOL,S.NAME SCHOOLNAME FROM EVALUATION_DDPJ E
LEFT JOIN COURSES C ON C.COURSENO=SUBSTRING(E.COURSENO,0,8)
LEFT JOIN TEACHERS T ON T.TEACHERNO=E.TEACHERNO
LEFT JOIN SCHOOLS S ON S.SCHOOL=T.SCHOOL
WHERE [YEAR]=:YEAR AND TERM=:TERM AND E.COURSENO LIKE :COURSENO AND C.COURSENAME LIKE :COURSENAME
AND (E.TEACHERNO LIKE :TEACHERNO OR T.NAME LIKE :NAME) AND SUPERVISOR LIKE :SUPERVISOR
ORDER BY E.[DATE] DESC